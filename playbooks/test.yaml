---
- hosts: all
  become: yes
  vars:
    ansible_user: alexei
    ansible_password: "{{ lookup('semaphore', 'ROOT-PASSWORD.password') }}"
    user_ssh_key: "{{ lookup('semaphore', 'USER-PUBKEY.key') }}"
    user_name: "{{ lookup('semaphore', 'USER-PUBKEY.username') }}"

  tasks:
    - name: Test SSH connection and ping
      ansible.builtin.command:
        cmd: ping -c 4 8.8.8.8
      register: ping_result

    - name: Show ping result
      ansible.builtin.debug:
        msg: "{{ ping_result.stdout_lines }}"

    - name: Test lookup from Semaphore key store
      debug:
        msg:
          - "ansible_user: {{ lookup('semaphore', 'ROOT-PASSWORD.username') }}"
          - "user_ssh_key: {{ lookup('semaphore', 'USER-PUBKEY.key') }}"
          - "user_name: {{ lookup('semaphore', 'USER-PUBKEY.username') }}"

...
